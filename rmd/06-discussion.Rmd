# Synthesis

Scales is a crucial consideration in ecology (Levin 1989). This dissertation presents new tools that can help researchers address questions related to demography and population dynamics across various temporal and spatial scales, and applies them to a focal genus to understand how climate may affect invasions. The computational framework introduced in chapter 2, `ipmr`, is used as both a standalone tool (Chapter 4, Bogdan et al. 2021) and as an underlying engine for synthesis work (Chapter 3). . In Chapter 3, I demonstrate how to use `ipmr` and `Rpadrino` to implement many IPMs across many spatial scales, and the supplementary materials provide a framework for addressing the relationship between range centrality and species fitness, demonstrating their use for macro-ecological applications. In chapter 4, I use a novel data collection techniques and `ipmr` to show that climate does not constrain the fitness of an invasive succulent plant species, suggesting that other factors may mediate its ability to colonize and thrive. 

### Advances in standalone IPMs

Integral projection models have become a popular tool for researchers across many disciplines to model population performance, evolutionary and life history trajectories, and species fitness in continuously structured populations (Ellner, Childs, & Rees 2016). Following their introduction in 2000 (Easterling, Ellner & Dixon 2000), researchers have developed increasingly complex IPMs to capture the nuanced responses to drivers such as climate, competition, and changes in continuous structure within discrete groups (e.g. two sex models, Erickson et al. 2017). In parallel with these theoretical and applied developments, researchers created computational tools that help create and analyze IPMs (Metcalf et al. 2013, Shefferson et al. 2020) Despite the uptick in their popularity, computational tools to implement IPMs have not kept pace with development of theory.

In chapter 2, I introduce `ipmr`. `ipmr` provides a miniature domain specific language to implement a wide range of IPMs. It does not attempt to handle vital rate modeling. Additionally, it provides functionality for basic analyses, and extensive documentation to aid researchers implement more complex analyses (Appendix 1 & Appendix 2). At present, it can handle both simple and general IPMs (_sensu_ Ellner & Rees 2006), deterministic and 2 types of stochastic models (Rees & Ellner 2009), and density/frequency-independent or -dependent models. Furthermore, it has been shown to handle two-sex models (W. Petry, personal communication), and nested combinations of continuous traits within discrete trait models (e.g. Ellner, Childs & Rees 2016, Chapter 6, Metcalf et al. 2009), which were either exceptionally difficult or impossible to implement with other _R_ packages. 

`ipmr` provides a syntax that mimics the mathematical notation of IPMs, and it does not attempt to abstract over the vital rate modeling step of IPM construction. These two features provide a number of advantages over prior work. First, this enables researchers to use any functional form they desire to specify the relationship between a trait value and a vital rate. This enables researchers to leverage new developments in regression modeling as they become available, rather than having to wait for `ipmr`'s maintainers to development a way of integrating them into the package. As long as a researcher can write out the functional form of the response (the regression technique includes a `predict()` method), then it is available for use in `ipmr`. Second, there is no limit on the number of vital rates, structuring traits, or how they may relate to each other (though, in practice, having too many of either may result in painfully slow performance - the curse of dimensionality spares no one). This enables researchers to model populations of increasing complexity without having to think too hard about how to actually implement the model - simply keep adding new sub-kernels to the IPM and `ipmr` will figure out the rest. Finally, this means that raw data is not strictly required to implement an IPM with `ipmr`. One can assume functional forms for different vital rates, work out reasonable ranges for parameter values, and then simulate populations at will. Prior to this development, researchers who wished to an _R_ package to implement their IPM would have to simulate data, fit regression models to that data, and then construct an IPM. This is no longer the case, and enables PADRINO (introduced in chapter 3) to drastically reduce the amount of data it has to store to reconstruct published IPMs.

### Summary of new features for synthesis

Another key piece of `ipmr`'s functionality that sets it apart from prior work is the `proto_ipm` data structure. This data structure provides a unified way of describing every IPM that one can implement with `ipmr`, and so is a common form that can be shared by both user-defined IPMs and ones defined by PADRINO, which is introduced in chapter 3. The `proto_ipm` is essentially a data frame that houses the symbolic definition of the sub-kernels, the parameters associated with said definition, and then the numerical details that implement the model (e.g. domain limits for continuous traits, integration rules, etc.). This means that once a user defines one or more `proto_ipm`s using their own data and/or data from PADRINO, a single set of computational machinery can be applied to implement their models, drastically reducing the amount of time required to conduct multi-model synthesis work. 

PADRINO provides a database that stores peer-reviewed, published IPMs, and `Rpadrino` leverage the aforementioned features of `ipmr` to reconstruct them for users. Specifically, PADRINO stores the mathematical form of published IPMs as text strings and `Rpadrino` makes use of _R_'s ability to parse text into code as well as modify code's evaluation environments to ensure that IPMs are reconstructed as published. `Rpadrino` breaks this down into two steps: re-generating `proto_ipm`s from PADRINO's symbolic model definitions, and then generating actual IPM objects. This segmenting of the steps enables users to combine their own IPMs with database-generated ones. Furthermore, the consistent structure of the outputs makes programming more complex synthesis more straightforward, as there is type-consistency in the outputs.

In Appendix 4, I show how to use these larger data sets for synthetic work. Appendix 4 shows how to use a single interface for implementing multiple models by re-constructing IPMs for 23 species and then computing sensitivity, elasticity, and mean lifetime recruit production. It further demonstrates the advantages of using an expression based framework by demonstrating how to alter vital rate functions and compute function value perturbations. The former is essential, as it encompasses two key use cases. The first is to correct unrealistic (though still passing peer review) functions. This allows users to make more complete use of the data stored in the database by correcting issues with published IPMs that would otherwise be unusable for a particular analysis. It also provides a framework for theoreticians to experiment with the consequences of altering the relationships between traits and vital rates using realistic demographic information. The latter point highlights one of the more attractive aspects of IPMs in general, which is that because they have many layers (i.e. parameters, vital rates functions, sub-kernels, and iteration kernels), there are varying levels of detail that one can compute _e.g._ sensitivity and elasticity metrics at. 

Appendix 5 demonstrates another important result for researchers interested in synthesis. This appendix combines data from user-defined models as well as other open access databases to informally address a long-standing question in ecology. It leverages range maps from BIEN (Maitner _et al._ 2017) and COMPADRE (Salguero-Gomez _et al._ 201X) to estimate the relationship between range centrality and population fitness. In doing so, I provide a code template that can be repurposed by other researchers to clean and filter publicaly accessible data and conduct larger scale syntheses than were previously possible.

### Applications

Thus far, I have spoken only of what might be done with these tools, rather than what has been done with them. Due to their novelty, there aren't many applications. Thus far, `ipmr` has been used to construct a simple model for a population of _Carpobrotus_ species in Israel (Bogdan et al. 2020), examine the effects of harvesting and fire on 3 economically important tree species in the Western Ghats of India (Neeraja _et al._ 2022), and to construct an age and size structured model of the impacts of temperature on the invasive Asian Carp (Brook 2021). In this chapter 4, I generate an IPM that examines population performance at the local scale and species performance at a macro-ecological scale to investigate how climate affects the _Carpobrotus_ genus across its native and invaded range. 

This model revealed that climate is not very important in determining the success of this invasive genus. There are a myriad of reasons that this may be, ranging from the statistical (lack of replication within climate bands to detect a climate effect i.e. a lack of power) to the biological (biotic interactions are more important and mask the relatively smaller climate effects). This reveals the importance of both temporal and spatial scale in studies like this. Regarding the former, single years are often not sufficient to capture a relationship between climate variables and population performance, due to, for example, single year deviations from longer-term weather patterns may confound signal, populations may experience different biotic interactions, and genetic bottlenecks that are imposed on a species via introduction to a new region (founder effects and subsequent adaptation). It has been suggested that this space for time substitution may work if we just sample lots of the spatial component. Indeed, 13 sites spread across 4 continents was not sufficient. It is far more likely that increasing replication within a climate band is more useful than trying to space sites across a climate gradient, because it is then possible to disentangle the within-band, across site variation on one hand, and the variation arising across climate bands on the other hand. 

### Limitations of these new frameworks

The limitations of the space for time substitutions are discussed in chapter 4 and in the preceding section, and so are not covered further here. `ipmr`, `Rpadrino`, and PADRINO, for all of their flexibility, do still have limitations. For example, `ipmr` is not able to accommodate time-lagged models (i.e. historical IPMs _sensu_ Shefferson _et al._ 2020) or periodic models (Letcher _et al._ 2014). Despite `ipmr`'s ability to handle semi- and non-parametric models for vital rates, a general syntax for describing them in PADRINO has not yet been developed either. Thus, IPMs that include, for example, generalized additive models (Wood 2017) are not yet available for synthesis. Another, more general, limitation of PADRINO is that the data contained therein may not be biologically correct - the only criteria for inclusion in that database is that the model has received some sort of peer review. Therefore, the models may be misleading. For an example of this how this limitation looks in practice (and how to overcome it provided it is recognized by the user), see Appendix 4. 

### Future directions for research

Scaling is a central issue in ecology, and unlikely to ever be completely resolved. However, this dissertation contributes to filling some of the gaps in our ability to do it meaningfully, and highlights some key areas for future research. The first one regards chapters 2 and 3. `ipmr` and `Rpadrino` are fantastic tools for generating point estimate of demographic quantities. However, quantifying uncertainty is an essential exercise for every scientist, regardless of field. Currently, neither framework provides off the shelf functionality to propagate uncertainty in parameters/vital rates into uncertainty in the demographic quantities of interest. At the moment, an `ipmr` vignette is the only resource provided to users to demonstrate how one might generate a posterior distribution for $\lambda$. This is certain;y insufficient given that no robust inference can be made without an understanding of how the outcome of interest may vary. This is an important area of future development for both tools to reach their full potential.

The outcome of interest in most studies extends beyond $\lambda$. While `ipmr` contains functionality to calculate deterministic and stochastic eigenvectors, it does not contain functionality to calculate much beyond that, and the documentation provides some overview of how to compute other metrics, though it is far from exhaustive. This is largely by design, as combining too much into a single piece of software makes it harder to maintain (the principle of conscious decoupling). A third package is needed that contains functionality to conduct more complex analyses on `ipmr` and `Rpadrino` outputs. 

There is an ever growing list of publications that make use of IPMs, and PADRINO will require constant attention to keep it updated. One priority for the digitization team should be to balance out the phylogenetic representation of the database. Currently, it is quite plant-heavy, and this is not reflective of the sampling effort made by the field as whole. Synthesis requires consideration of sample sizes and the balance of each factor under consideration, so it would be ideal to allow users to make full use of data without having to correct for these issues as much as they currently may have to.

Ecologists are aware that large scale drivers may exhibit small effect sizes when studied at finer spatial or temporal grains. Chapter 4 highlights this phenomenon. Key next steps for this work are to ensure that future sampling adds additional sites that are close to existing ones, rather than attempting to add sites that occupy additional climate space. 

### Concludng remarks

The computational framework introduced in chapters 2 and 3 provides a new way for researchers to generate and synthesize demographic data across a variety grains and scales. Their flexibility will hopefully provide researchers with a toolkit to address broader questions with the appropriate methods and statistical power. Despite their limitations, they have already found use in the literature. As they are open source and open access, both using and contributing to them can become a collaborative endeavor.

In practice, devising an appropriate sampling scheme for detecting climate drivers on demographic responses is far more nuanced and challenging than simply sampling far and wide. Careful consideration must be given to the spatial and temporal scales of the expected effects in question, and to the level of replication required to detect them. On the other hand, regardless of the presence or absence of a detectable climate effect on fitness, we do know that invasive species are harmful to biodiversity and economic interests. We should not take the absence of an observed climate effect to indicate that a species poses no threat beyond its current distribution, and policy should reflect this existing knowledge. 

### Citations

1. Bogdan, A., Levin, S.C., Salguero-Gomez, R. (2020) Demographic analysis of an Israeli Carpobrotus population. PLoSONE. https://doi.org/10.1371/journal.pone.0250879 

2. Ellner, S.P., Childs, D.Z., Rees, M. (2016) Data-driven modelling of structured populations: a practical guide to the integral projection model. Basel, Switzerland: Springer International Publishing AG

3. Easterling, M.R., Ellner, S.P., & Dixon, P.M. (2000). Size specific sensitivity: applying a new structured population model. Ecology 81(3): 694-708.

4. Ellner, S.P. & Rees, M. (2006). Integral Projection Models for species with complex demography. The American Naturalist 167(3): 410-428.

5. Rees, M., & Ellner, S. P. (2009). Integral projection models for populations in temporally varying environments. Ecological Monographs, 79(4), 575–594. https://doi.org/10.1890/08-1474.1.

6. Maitner, B., Boyle B., Casler N., Condit R., Donoghue J., Duran S.M., et al. (2017) The bien r package:
A tool to access the Botanical Information and Ecology Network (BIEN) database. Methods in Ecology
and Evolution 9(2): 373-379. https://doi.org/10.1111/2041-210X.12861

7. Levin, S.A. (1989). The problem of pattern and scale in ecology. Ecology 73(6): 1943-1967.

8. Erickson, R.A., Eager, E.A., Brey, M.B., Hansen, M.J., & Kocovsky, P.M. (2017). An integral projection model with YY-males and application to evaluating grass carp control. Ecological Modelling 361: 14-25. https://doi.org/10.1016/j.ecolmodel.2017.07.030

9. Metcalf, C. J. E., McMahon, S. M., Salguero-Gómez, R., & Jongejans, E. (2013). IPMpack: An R package for integral projection models. Methods in Ecology and Evolution., 4(2), 195–200. https://doi.org/10.1111/2041-210x.12001

10. Shefferson, R. P., Kurokawa, S., & Ehrlen, J. (2020). LEFKO3: Analysing individual history through size-classified matrix population models. Methods in Ecology and Evolution. https://doi. org/10.1111/2041-210X. 13526

11. Metcalf, C. J. E., Horvitz, C. C., Tuljapurkar, S., & Clark, D. A. (2009). A time to grow and a time to die: a new way to analyze the dynamics of size, light, age, and death of tropical trees. Ecology, 90(10), 2766-2778.

12. Salguero-Gómez, R, Jones, O.R., Archer, C.A., Buckley, Y.M., Che-Castaldo, J., Caswell, C., Hodgson, D., Scheuerlein, A., Conde, D.A., Brinks, E., de Buhr, H., Farack, C., Gottschalk, F., Hartmann, A., Henning, A., Hoppe, G., Roemer, G., Runge, J., Ruoff, T., etal. (2014) The COMPADRE Plant Matrix Database: an online repository for plant population dynamics. Journal of Ecology 103: 202-218. https://doi.org/10.1111/1365-2745.12334

13. Neeraja, U. V., Saneesh, C. S., Dyda, V., Reddy, H., Yadama, G. N., & Knight, T. M. (2022). Harvesting has variable effects on demographic rates and population growth across three dry forest tree species. Biotropica, 54(6), 1376-1389.

14. Brook, M. (2021). Impacts of temperature on Asian Carp life history and population growth (Master's thesis, University of Waterloo).

15. Letcher, B.H., Schueller, P., Bassar, R.D., Nislow, K.H., Coombs, J.A.,Sakrejda, K. et al. (2014). Robust estimates of environmental effects on population vital rates: an integrated capture-recapture model of seasonal brook trout growth, survival and movement in a stream network. Journal of Animal Ecology 84(2): 337-352. https://doi.org/10.1111/1365-2656.12308

16. Wood, S.N. (2017). Generalized Additive Models: An Introduction with R (2nd edition). Chapman and Hall/CRC.

